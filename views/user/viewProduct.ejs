<!DOCTYPE html>
<html lang="en">
<head>
<title>Single Product</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="Colo Shop Template">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="/user/styles/bootstrap4/bootstrap.min.css">
<link href="/user/plugins/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/user/plugins/OwlCarousel2-2.2.1/owl.carousel.css">
<link rel="stylesheet" type="text/css" href="/user/plugins/OwlCarousel2-2.2.1/owl.theme.default.css">
<link rel="stylesheet" type="text/css" href="/user/plugins/OwlCarousel2-2.2.1/animate.css">
<link rel="stylesheet" href="/user/plugins/themify-icons/themify-icons.css">
<link rel="stylesheet" type="text/css" href="/user/plugins/jquery-ui-1.12.1.custom/jquery-ui.css">
<link rel="stylesheet" type="text/css" href="/user/styles/single_styles.css">
<link rel="stylesheet" type="text/css" href="/user/styles/main_styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.4.17/dist/sweetalert2.min.css">



<link rel="stylesheet" type="text/css" href="/user/styles/single_responsive.css">


</head>

<body>

<div class="super_container">

	<!-- Header -->

	<header class="header trans_300">

		<!-- Top Navigation -->

		

		<!-- Main Navigation -->

		<div class="main_nav_container">
			<div class="container">
				<div class="row">
					<div class="col-lg-12 text-right">
						<div class="logo_container">
							<a href="#">ZORO<span>'S</span></a>
						</div>
						<nav class="navbar">
							<ul class="navbar_menu">
								<li><a href="/home">home</a></li>
								<li><a href="#">shop</a></li>
								<li><a href="#">promotion</a></li>
								<li><a href="#">pages</a></li>
								<li><a href="#">blog</a></li>
								<li><a href="contact.html">contact</a></li>
							</ul>
							<ul class="navbar_user">
								<li><a href="#"><i class="fa fa-search" aria-hidden="true"></i></a></li>
								<li><a href="#"><i class="fa fa-user" aria-hidden="true"></i></a></li>
								<li>
									<a href="/wishlist"
									  ><i class="fa fa-heart" aria-hidden="true"></i>
									  <span id="wishlist_items" class="checkout_items">
										<%= userWishlist.length %>
									  </span>
									</a>
								  </li>
								  <li class="checkout">
									<a href="/cart">
									  <i class="fa fa-shopping-cart" aria-hidden="true"></i>
									  <span id="checkout_items" class="checkout_items">
										<%= userCart.length %>
									  </span>
									</a>
								  </li>
								
							</ul>
							<div class="hamburger_container">
								<i class="fa fa-bars" aria-hidden="true"></i>
							</div>
						</nav>
					</div>
				</div>
			</div>
		</div>

	</header>

	<div class="fs_menu_overlay"></div>

	<!-- Hamburger Menu -->

	<div class="hamburger_menu">
		<div class="hamburger_close"><i class="fa fa-times" aria-hidden="true"></i></div>
		<div class="hamburger_menu_content text-right">
			<ul class="menu_top_nav">
				<li class="menu_item has-children">
					<a href="#">
						usd
						<i class="fa fa-angle-down"></i>
					</a>
					<ul class="menu_selection">
						<li><a href="#">cad</a></li>
						<li><a href="#">aud</a></li>
						<li><a href="#">eur</a></li>
						<li><a href="#">gbp</a></li>
					</ul>
				</li>
				<li class="menu_item has-children">
					<a href="#">
						English
						<i class="fa fa-angle-down"></i>
					</a>
					<ul class="menu_selection">
						<li><a href="#">French</a></li>
						<li><a href="#">Italian</a></li>
						<li><a href="#">German</a></li>
						<li><a href="#">Spanish</a></li>
					</ul>
				</li>
				<li class="menu_item has-children">
					<a href="#">
						My Account
						<i class="fa fa-angle-down"></i>
					</a>
					<ul class="menu_selection">
						<li><a href="#"><i class="fa fa-sign-in" aria-hidden="true"></i>Sign In</a></li>
						<li><a href="#"><i class="fa fa-user-plus" aria-hidden="true"></i>Register</a></li>
					</ul>
				</li>
				<li class="menu_item"><a href="#">home</a></li>
				<li class="menu_item"><a href="#">shop</a></li>
				<li class="menu_item"><a href="#">promotion</a></li>
				<li class="menu_item"><a href="#">pages</a></li>
				<li class="menu_item"><a href="#">blog</a></li>
				<li class="menu_item"><a href="#">contact</a></li>
			</ul>
		</div>
	</div>

	<div class="container single_product_container">
		<div class="row">
			<div class="col">

				<!-- Breadcrumbs -->

				<div class="breadcrumbs d-flex flex-row align-items-center">
					<ul>
						<% if(isLoggedIn){ %>

							<li><a href="/home">Home</a></li>
						<% }else{ %>

							<li><a href="/">Home</a></li>
						<% } %>
						<!-- <li class="active"><a href="/categories"><i class="fa fa-angle-right" aria-hidden="true"></i><%= product.category.categoryName %></a></li> -->
						<li class="active"><a href="#"><i class="fa fa-angle-right" aria-hidden="true"></i>Single Product</a></li>
					</ul>
				</div>

			</div>
		</div>

		<div class="row">
			<div class="col-lg-7">
				<div class="single_product_pics">
					<div class="row">
						<div class="col-lg-3 thumbnails_col order-lg-1 order-2">
							<div class="single_product_thumbnails">
								<ul>
									<li><img src="/images/<%= product.images[0] %>" alt="" data-image="images/<%= product.images[0] %>"></li>
									<li class="active"><img src="/images/<%= product.images[1] %>" alt="" data-image="images/<%= product.images[1] %>"></li>
									<li><img src="/images/<%= product.images[2] %>" alt="" data-image="images/<%= product.images[2] %>"></li>
								</ul>
							</div>
						</div>
						<div class="col-lg-9 image_col order-lg-2 order-1">

							<div class="single_product_image">
								<div class="single_product_image_background" data-BigImgsrc="/images/<%= product.images[0] %>" style="background-image:url('/images/<%= product.images[0] %>')"></div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col-lg-5">
				<div class="product_details">
					<div class="product_details_title">
						<h2><%= product.productName %> </h2>
						<% if(product.status !== "Available"){ %>
							<h4 style="color: red;" >Out Of Stock</h4>

						<% }%>
					</div>
					<div class="free_delivery d-flex flex-row align-items-center justify-content-center">
						<span class="ti-truck"></span><span>free delivery</span>
					</div>
					<div class="original_price"><i class="fa fa-rupee"></i><%= product.regularPrice %></div>
					<div class="product_price" id=""><i class="fa fa-rupee"></i><a id="price"><%= product.salePrice %></a></div>
					<ul class="star_rating">
						<li><i class="fa fa-star" aria-hidden="true"></i></li>
						<li><i class="fa fa-star" aria-hidden="true"></i></li>
						<li><i class="fa fa-star" aria-hidden="true"></i></li>
						<li><i class="fa fa-star" aria-hidden="true"></i></li>
						<li><i class="fa fa-star-o" aria-hidden="true"></i></li>
					</ul>
					<!-- <div class="product_color">
						<span>Select Color:</span>
						<ul>
							<li style="background: #e54e5d"></li>
							<li style="background: #252525"></li>
							<li style="background: #60b3f3"></li>
						</ul>
					</div> -->
					<div>
						<% if(product.status !== "Available" || product.stock < 1){ %>
							<h6 style="color: red;" >Out Of Stock</h6>
							
							<% } else{%>
								Stock left : <%= product.stock %>
								
						<% } %>
					</div>
					<div class="quantity d-flex flex-column flex-sm-row align-items-sm-center">
						
						<% if(product.status == "Available" && product.stock  > 0 ){ %>
						<span>Quantity:</span>
						<div class="quantity_selector">
							<span class="minus" ><i class="fa fa-minus" aria-hidden="true"></i></span>
							<span id="stockLeft" class="d-none"><%= product.stock %></span>
							<span id="quantity_value">1</span>
							<span style="padding: 0px 20px; " class="d-none" id="plus1"><i class="fa fa-plus" aria-hidden="true" ></i></span>
							<span class="plus"  id="plus" ><i class="fa fa-plus" aria-hidden="true" ></i></span>
						</div>
						<% if(isLoggedIn){%>

						<div class=" add_to_cart_butto btn btn-warning col-4 " id="add" style="margin: 10px;" ><a  >add to cart</a></div>
						<% } else {%>
							<a href="/login"><div class=" add_to_cart_butto btn btn-warning" onclick="loginNotify()" >add to cart</div></a>
						<%}%>

							
						<% } else {%>
								
						<div class="red_button add_to_cart_button1" id="" ><a  >Out Of Stock</a></div>
						<% }%>
						<!-- <button onclick="addToCarts()">sfgd</button> -->
						 <% if(isLoggedIn){%>
							<div onclick="getProductId('<%= product._id %>')" class="product_favorite d-flex flex-column align-items-center justify-content-center <%= userWishlist.some(wish => wish.productId._id.toString() === product._id.toString()) ? 'active' : '' %> " ></div>
							
						 <% } %>
							
					</div>
				</div>
			</div>
		</div> 
		

	</div>

	<!-- Tabs -->

	<div class="tabs_section_container">

		<div class="container">
			<div class="row">
				<div class="col">
					<div class="tabs_container">
						<ul class="tabs d-flex flex-sm-row flex-column align-items-left align-items-md-center justify-content-center">
							<li class="tab active" data-active-tab="tab_1"><span>Description</span></li>
							<li class="tab" data-active-tab="tab_2"><span>Additional Information</span></li>
							<li class="tab" data-active-tab="tab_3"><span>Reviews (2)</span></li>
						</ul>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col">

					<!-- Tab Description -->

					<div id="tab_1" class="tab_container active">
						<div class="row">
							<div class="tab_title">
								<h4>Description</h4>

								<p><%= product.description %></p>

							</div>
							
						</div>
					</div>

					<!-- Tab Additional Info -->

					<div id="tab_2" class="tab_container">
						<div class="row">
							<div class="col additional_info_col">
								<div class="tab_title additional_info_title">
									<h4>Additional Information</h4>
								</div>
								<!-- <p>COLOR:<span>Gold, Red</span></p> -->
								<p>SIZE:<span><%= product.size %></span></p>
								<p>category :<span><%= product.category.categoryName %></span></p>
							</div>
						</div>
					</div>

					<!-- Tab Reviews -->

					<div id="tab_3" class="tab_container">
						<div class="row">

							<!-- User Reviews -->

							<div class="col-lg-6 reviews_col">
								<div class="tab_title reviews_title">
									<h4>Reviews (2)</h4>
								</div>

								<!-- User Review -->

								<div class="user_review_container d-flex flex-column flex-sm-row">
									<div class="user">
										<div class="user_pic"></div>
										<div class="user_rating">
											<ul class="star_rating">
												<li><i class="fa fa-star" aria-hidden="true"></i></li>
												<li><i class="fa fa-star" aria-hidden="true"></i></li>
												<li><i class="fa fa-star" aria-hidden="true"></i></li>
												<li><i class="fa fa-star" aria-hidden="true"></i></li>
												<li><i class="fa fa-star-o" aria-hidden="true"></i></li>
											</ul>
										</div>
									</div>
									<div class="review">
										<div class="review_date">27 Aug 2016</div>
										<div class="user_name">Brandon William</div>
										<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
									</div>
								</div>

								<!-- User Review -->

								<div class="user_review_container d-flex flex-column flex-sm-row">
									<div class="user">
										<div class="user_pic"></div>
										<div class="user_rating">
											<ul class="star_rating">
												<li><i class="fa fa-star" aria-hidden="true"></i></li>
												<li><i class="fa fa-star" aria-hidden="true"></i></li>
												<li><i class="fa fa-star" aria-hidden="true"></i></li>
												<li><i class="fa fa-star" aria-hidden="true"></i></li>
												<li><i class="fa fa-star-o" aria-hidden="true"></i></li>
											</ul>
										</div>
									</div>
									<div class="review">
										<div class="review_date">27 Aug 2016</div>
										<div class="user_name">Brandon William</div>
										<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
									</div>
								</div>
							</div>

							<!-- Add Review -->

							

						</div>
					</div>

				</div>
			</div>
		</div>

	</div>
	<div class="new_arrivals">
		<div class="container">
			<div class="row">
				<div class="col text-center">
					<div class="section_title new_arrivals_title">
						<h2>Similiar Products</h2>
						 
						
					</div>
				</div>
			</div>
			
			<div class="row">
				<div class="col">
					<div class="product-grid" data-isotope='{ "itemSelector": ".product-item", "layoutMode": "fitRows" }'>

						<!-- Product 1 -->
						<% products.forEach((prod)=>{ %>

							
							
								<div class="product-item men m-4 p-1" >
									<a href="/viewProduct/<%= prod._id %>">
									<div class="product discount product_filter">
										<div class="product_image">
											<img src="/images/<%= prod.images[0] %>" alt="">
										</div>
										<div
										class="favorite favorite_left <%= userWishlist.some(wish => wish.productId._id.toString() === prod._id.toString()) ? 'active' : '' %>"
										id="wishlist"
										onclick="getProductId('<%= prod._id %>')"
									  ></div>										<div class="product_bubble product_bubble_right product_bubble_red d-flex flex-column align-items-center"><span>-<i class="fa fa-rupee"></i><%= prod.regularPrice - prod.salePrice  %></span></div>
										<div class="product_info">
											<h6 class="product_name"><a href="/viewProduct/<%= prod._id %>"><%= prod.productName %></a></h6>
											<div class="product_price"><i class="fa fa-rupee"></i><%= prod.salePrice %><span><i class="fa fa-rupee"></i><%= prod.regularPrice %></span></div>
										</div>
									</div>
									</a>
									<div class="red_button add_to_cart_button"><a href="#">add to cart</a></div>
								</div>

						
						<% }) %>
						


						

						
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Benefit -->

	

	<!-- Newsletter -->

	<div class="newsletter">
		<div class="container">
			<div class="row">
				<div class="col-lg-6">
					<div class="newsletter_text d-flex flex-column justify-content-center align-items-lg-start align-items-md-center text-center">
						<h4>Newsletter</h4>
						<p>Subscribe to our newsletter and get 20% off your first purchase</p>
					</div>
				</div>
				<div class="col-lg-6">
					<form action="post">
						<div class="newsletter_form d-flex flex-md-row flex-column flex-xs-column align-items-center justify-content-lg-end justify-content-center">
							<input id="newsletter_email" type="email" placeholder="Your email" required="required" data-error="Valid email is required.">
							<button id="newsletter_submit" type="submit" class="newsletter_submit_btn trans_300" value="Submit">subscribe</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>

	<!-- Footer -->

	<footer class="footer">
		<div class="container">
			<div class="row">
				<div class="col-lg-6">
					<div class="footer_nav_container d-flex flex-sm-row flex-column align-items-center justify-content-lg-start justify-content-center text-center">
						<ul class="footer_nav">
							<li><a href="#">Blog</a></li>
							<li><a href="#">FAQs</a></li>
							<li><a href="contact.html">Contact us</a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-6">
					<div class="footer_social d-flex flex-row align-items-center justify-content-lg-end justify-content-center">
						<ul>
							<li><a href="#"><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
							<li><a href="#"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
							<li><a href="#"><i class="fa fa-instagram" aria-hidden="true"></i></a></li>
							<li><a href="#"><i class="fa fa-skype" aria-hidden="true"></i></a></li>
							<li><a href="#"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li>
						</ul>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-lg-12">
					<div class="footer_nav_container">
						<div class="cr">©2018 All Rights Reserverd. This template is made with <i class="fa fa-heart-o" aria-hidden="true"></i> by <a href="#">Colorlib</a> &amp; distributed by <a href="https://themewagon.com">ThemeWagon</a></div>
					</div>
				</div>
			</div>
		</div>
	</footer>

</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
    $(document).ready(function(){
        $('.single_product_image').on('mousemove', function(e) {
            let zoomedImage = $(this).find('.single_product_image_background');
            let offsetX = e.offsetX;
            let offsetY = e.offsetY;
            let width = $(this).width();
            let height = $(this).height();

            let moveX = (offsetX / width) * 100;
            let moveY = (offsetY / height) * 100;

            zoomedImage.css({
                'transform-origin': `${moveX}% ${moveY}%`,
                'transform': 'scale(2)'  // Adjust zoom scale as needed
            }).addClass('zoomed');
        }).on('mouseleave', function() {
            $(this).find('.single_product_image_background').css({
                'transform': 'scale(1)'
            }).removeClass('zoomed');
        });
    });
	
    const price = parseInt(document.getElementById('price').textContent);  // Use textContent instead of value
    
	const quantity = parseInt(document.getElementById('quantity_value').textContent);  // Use textContent instead of value
// alert(price)

	document.getElementById('add').addEventListener('click', () => {
			const cartNumber = document.getElementById('checkout_items')
			const price = parseInt(document.getElementById('price').textContent);  // Use textContent instead of value
			const quantity = parseInt(document.getElementById('quantity_value').textContent);  // Use textContent instead of value

			const productData = {
				productId: "<%= product._id %>",  // Ensure this value is rendered correctly
				quantity: quantity,
				productName: "<%= product.productName %>",
				totalPrice: price * quantity,
			};

			
			axios.post('/addToCart', productData)
				.then(response => {
					// Success SweetAlert notification
					if (response.data.success === true) {
						Swal.fire({
							icon: 'success',
							title: 'Success',
							text: 'Added to cart successfully!',
							confirmButtonText: 'OK'
						})
							.then(() => {
								window.location.reload();
							});
						// cartNumber.innerText = ""
					} else {
						Swal.fire({
							icon: 'error',
							title: 'error',
							text: response.data.message,
							confirmButtonText: 'OK'
						});

					}
					console.log("Quantity updated:", response.data);
				})
				.catch(error => {
					// Error SweetAlert notification
					Swal.fire({
						icon: 'error',
						title: 'Error',
						text: 'There was an error updating the quantity. Please try again.',
						confirmButtonText: 'OK'
					});
					console.error("Error updating quantity:", error);
				});

		});

	const loginNotify = () => {
		Swal.fire({
						icon: 'warning',
						title: 'Warning',
						text: 'If you want to proceed more ',
						confirmButtonText: 'OK'
					});
	}



// const add = document.getElementById('click',()=>{
	
// 		const price = parseInt(document.getElementById('price').value);
// 		const quantity = parseInt(document.getElementById('quantity_value').value)

// 		const productData = {
// 			productId:<%= product._id %>,
// 			quantity:quantity,
// 			productName:<%= product.productName %>,
// 			totalPrice: price * quantity,
			


// 		}
// 		axios.post('/addToCart', productData)
//             .then(response => {
//                 console.log("Quantity updated:", response.data);
//             })
//             .catch(error => {
//                 console.error("Error updating quantity:", error);
//             });

	
// })
	 
	// function addToCart() {
	// 	const price = parseInt(document.getElementById('price').value);
	// 	const quantity = parseInt(document.getElementById('quantity_value').value)

	// 	const productData = {
	// 		productId:<%= product._id %>,
	// 		quantity:quantity,
	// 		productName:<%= product.productName %>,
	// 		totalPrice: price * quantity,
			


	// 	}
	// 	axios.post('/addToCart', productData)
    //         .then(response => {
    //             console.log("Quantity updated:", response.data);
    //         })
    //         .catch(error => {
    //             console.error("Error updating quantity:", error);
    //         });

	// }


	// function updateQuantity(event, action) {
    //         // event.preventDefault();  // Prevent default link behavior

    //         const quantityElement = document.getElementById("quantity");
    //         let quantity = parseInt(quantityElement.innerText);

    //         // Increment or decrement quantity locally
    //         if (action === 'increment') {
    //             quantity += 1;
    //         } else if (action === 'decrement' && quantity > 1) {
    //             quantity -= 1;
    //         }

    //         // Update the quantity in the DOM
    //         quantityElement.innerText = quantity;

    //         // Make an Axios request to update the quantity on the server
    //         axios.post('/update-quantity', {
    //             productId: '12345',  // Example product ID
    //             quantity: quantity
    //         })
    //         .then(response => {
    //             console.log("Quantity updated:", response.data);
    //         })
    //         .catch(error => {
    //             console.error("Error updating quantity:", error);
    //         });
    //     }
</script>	

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script src="/user/js/jquery-3.2.1.min.js"></script>
<script src="/user/styles/bootstrap4/popper.js"></script>
<script src="/user/styles/bootstrap4/bootstrap.min.js"></script>
<script src="/user/plugins/Isotope/isotope.pkgd.min.js"></script>
<script src="/user/plugins/OwlCarousel2-2.2.1/owl.carousel.js"></script>
<script src="/user/plugins/easing/easing.js"></script>
<script src="/user/plugins/jquery-ui-1.12.1.custom/jquery-ui.js"></script>
<script src="/user/js/single_custom.js"></script>
<script src="/user/js/custom.js"></script>

<script src='/user/plugins/zoom/jquery.zoom.min.js' type="text/javascript"></script><!-- product zoom -->

<script>
	let productId;
      function getProductId(product) {
        productId = product;
      }
</script>
</body>

</html>
